---
# Traefik ForwardAuth middleware that checks requests against CrowdSec
# Apply to ingresses with annotation:
#   traefik.ingress.kubernetes.io/router.middlewares: security-crowdsec-bouncer@kubernetescrd
apiVersion: traefik.io/v1alpha1
kind: Middleware
metadata:
  name: crowdsec-bouncer
  namespace: security
spec:
  forwardAuth:
    address: http://crowdsec-bouncer.security.svc.cluster.local:8080/api/v1/forwardAuth
    trustForwardHeader: true
